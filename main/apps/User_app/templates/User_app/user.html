<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Users Page</title>
    <meta name="viewport" content="width=device-width; maximum-scale=1; minimum-scale=1;" />
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" media="all" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
    {% load staticfiles %}
    <link rel="stylesheet" href="{% static 'User_app/css/profile.css' %}">
    <link rel="stylesheet" href="{% static 'global/css/review_card.css' %}">
    <script type="text/javascript" src="{% static 'User_app/js/user.js' %}"></script>

    <!-- for the menu -->
    <script type="text/javascript" src="{% static 'global/js/nav-bar.js'%}"></script>
    <link rel="stylesheet" href="{% static 'global/css/navbarStyle.css'%}"/>
  </head>
  <body>
    {% include "../global/navbar.html" %}
    <div class="space-for-top"></div>
    <div class="search-bar">
      <div class="ui-widget">
        <form class="" action="/searchUsers" method="post">
          {% csrf_token %}

          <input name="person" id="places" placeholder="Find Friends">

        </form>
      </div>
    </div>

    <div class="header-top">

    </div>
    <div class="content-wrapper">
      <div class="header">
        <div class="userPage">
          <div class="profPic">
            {% if user.is_profile_pic == True %}
            <img id="proImg" src="{{user.pic_name}}">
            {% else %}
            <div class="profile-pic-placeholder">
              <p>{{user.pic_name}}</p>
            </div>
            {% endif %}
          </div>
          <!-- <img src="{% static "User_app/blankUser.png" %}" width="150" height="150"/> -->
          <h1 class="user-name">{{ user.first_name}} {{user.last_name}}</h1>
          <div class="list-buttons">

            <div class="list" id="list-1">
              <h3>Followers</h3>
              <p>{{followers}}</p>
            </div>
            <div class="list" id="list-2">
              <h3>Following</h3>
              <p>{{following}}</p>
            </div>
            <div class="list" id="list-3">
              <h3>Reviews</h3>
              <p>{{length}}</p>
            </div>
          </div>
          {% if request.session %}
          {% if myFollow == "you don't follow" %}
          <a href="/connect/add/{{user.profile_id}}"><button class="follow-button" type="button" name="button">Follow Me</button></a><br>
          {% else %}
          <a href="/connect/remove/{{user.profile_id}}"><button class = 'unfollow-button' type="button" name="button">Unfollow</button></a><br>
          {% endif %}
          {% endif %}
        </div>

      </div>


      <div class="pageFeed">

        <div class="reviewFeed">
          <h3 class="names-review">{{user.first_name}}'s Reviews</h3>
          <div class="name-bumper"></div>
          {% if length == 0 %}
          <h4>No reviews yet</h4>
          {% endif %}
          {% for review in reviews %}
          <div class="review-total-holder">
            <div class="review-card-min {{review.overall_color}}">
              <img src="https://image.tmdb.org/t/p/w1280/{{review.poster_path}}" alt="">
              <div class="info-score">
                <p class="score-overall {{review.overall_color}}">{{review.overall_score}}</p>
              </div>
            </div>
            <div class="review-card-full">
              <div class="overall-score-full">
                <p>Overall Score</p>
                <div class="bumper-reviewcard"></div>
                <div class="break"></div>
                <p class="score-overall-full {{review.overall_color}}">{{review.overall_score}}</p>
              </div>
              <div class="subscores">
                <p>Story</p>
                <div class="score-bar {{review.story_percent}} {{review.story_color}} "></div>
                <p>Entertainment</p>
                <div class="score-bar {{review.ent_percent}} {{review.ent_color}} "></div>
                <p>Acting</p>
                <div class="score-bar {{review.act_percent}} {{review.act_color}} "></div>
                <p>Visual</p>
                <div class="score-bar {{review.vis_percent}} {{review.vis_color}} "></div>
                <p>Sound</p>
                <div class="score-bar {{review.sound_percent}} {{review.sound_color}} "></div>
              </div>
            </div>
            <div class="timestamp">
              {% if review.day_difference < 1 and review.hour_difference < 1 %}
              {% if review.minute_difference == 0 %}
              <h2>Just now</h2>
              {% elif review.minute_difference == 1 %}
              <h2>{{review.minute_difference}} minute ago</h2>
              {% else %}
              <h2>{{review.minute_difference}} minutes ago</h2>
              {% endif %}
              {% elif review.day_difference < 1 and review.hour_difference >= 1  %}
              {% if review.hour_difference == 1 %}
              <h2>{{review.hour_difference}} hour ago</h2>
              {% else %}
              <h2>{{review.hour_difference}} hours ago</h2>
              {% endif %}
              {% else %}
              <h2>{{review.day_difference}} days ago</h2>
              {% endif %}
            </div>

          </div>

          {% endfor%}

        </div>


        <div class="followerFeed" style="display:none">
          <h3 class="names-review">{{user.first_name}}'s Followers</h3>
          <div class="name-bumper"></div>
          <div class="space-for-top"></div>
          {% if followers == 0 %}
          <h4>{{user.first_name}} has no followers yet</h4>
          {% endif %}
          {% for follower in followers_dic %}
            {% if follower.profile_id == request.session.user %}
            <div class="followerDiv">
              {% if follower.is_profile_pic == True %}
              <div class="profile-pic-holder-small">
                <img src="{{follower.pic_name}}"/>
              </div>
              {% else %}
              <div class="profile-pic-holder-small">
                  <p>{{follower.pic_name}}</p>
              </div>
              {% endif %}
              <p>(You)</p>
            </div>
            {% else %}
            <a href="/user/{{ follower.profile_id }}">
            <div class="followerDiv">
                {% if follower.is_profile_pic == True %}
                <div class="profile-pic-holder-small">
                  <img src="{{follower.pic_name}}"/>
                </div>
                {% else %}
                <div class="profile-pic-holder-small">
                    <p>{{follower.pic_name}}</p>
                </div>
                {% endif %}
                <p class="user-name">{{follower.first_name}} {{follower.last_name}}</p>
            </div>
            </a>
            {% endif %}
            {% endfor %}
        </div>


        <div class="followingFeed" style="display:none">
          <h3 class="names-review">{{user.first_name}}'s Following</h3>
          <div class="name-bumper"></div>
          <div class="space-for-top"></div>
          {% if following == 0 %}
          <h4>{{user.first_name}} doesn't follow anyone yet</h4>
          {% endif %}
          {% for follow in following_dic %}
          <a href="/user/{{ follow.profile_id }}">
          <div class="followerDiv">
            {% if follow.is_profile_pic == True %}
            <div class="profile-pic-holder-small">
              <img src="{{follow.pic_name}}"/>
            </div>
            {% else %}
            <div class="profile-pic-holder-small">
              <p>{{follow.pic_name}}</p>
            </div>
            {% endif %}
            <p class="user-name" >{{follow.first_name}} {{follow.last_name}}</p>
          </div>
          </a>

          {% endfor %}
        </div>
      </div> <!--end of the pageFeed -->

    </div>
  </body>
</html>
